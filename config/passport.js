var JwtStrategy=require('passport-jwt').Strategy,ExtractJwt=require('passport-jwt').ExtractJwt,Admin=require('../models/admin'),User=require('../models/user'),config=require('../config/database');module.exports=function(a){var b={};b.jwtFromRequest=ExtractJwt.fromAuthHeaderWithScheme('jwt'),b.secretOrKey=config.secret,a.use(new JwtStrategy(b,function(c,d){User.getUserById(c.data._id,function(e,f){if(e){return d(e,!1)}return f?d(null,f):d(null,!1)})}))};